{% extends "base.html" %}
{% load thumbnail %}
{% load manifest %}
{% block title %} {{ version.extension.name }} - GNOME Shell Extensions {% endblock %}

{% if is_preview %}
{% block extra-messages %}
    <p class="message info">
      This is a preview of how your extension's page will look.
      You can edit any of the things marked in yellow by clicking on them.
    </p>
{% endblock %}
{% endif %}

{% block body %}
{% with extension=version.extension %}
    <div class="extension"
         data-uuid="{{ extension.uuid }}"
         data-manifest="{% manifest_url version %}">
      <div class="button{% if is_preview %} insensitive{% endif %}"></div>
      {% for screenshot in extension.screenshot_set.all %}
      {% thumbnail screenshot.image "300x200" as th %}
      <a href="{{ screenshot.image.url }}" class="screenshot featured"><img src="{{ th.url }}" /></a>
      {% endthumbnail %}
      {% endfor %}

      <h3 id="extension_name">{{ extension.name }}</h3>
      <span class="author">by {{ extension.creator }}</span>
      <p class="description" id="extension_description">
        {{ extension.description }}
      </p>

      <ul>
        {% if user == extension.creator %}
        <li><a href="{% url extensions-upload-file pk=extension.pk %}">Upload a new version</a></li>
        <li><a href="{% url extensions-upload-screenshot pk=extension.pk %}">Upload screenshot</a></li>
        {% endif %}
      </ul>
      <hr>
      {% if is_preview %}
      Comments will appear here after review.
      {% else %}
      {% include "extensions/comments.html" %}
      {% endif %}
</div>
{% endwith %}
{% endblock %}
{% block document-ready %}
    {{ block.super }}
    $("abbr.timestamp").timeago();
    $(".extension").buttonify();
    $(".comment .rating").each(function() {
      $(this).find('input').rating();
    });
    $("form .rating").rating();
    $("h3, p.description").csrfEditable("{% url extensions-ajax-inline pk=version.extension.pk %}", "{{ csrf_token }}");
{% endblock %}
